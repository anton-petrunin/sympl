\chapter{Знакомство с геометрией}\label{chap:2}

В этой главе обсуждаются биинвариантные финслеровы метрики на группе гамильтоновых диффеоморфизмах и определяется хоферовская геометрия.

\section{Вариационная задача}\label{2.1}

Какая минимальная энергия необходима для получения данного гамильтонова диффеоморфизма $\phi$? 
Этот естественный вопрос можно формализовать следующим образом.
Рассмотрим всевозможные гамильтоновы потоки $\{f_t\}$, $t \in [0; 1]$ такие, что $f_0 = \1$ и $f_1 = \phi$.
Для каждого потока возьмём, соответсвующий ему нормированый гамильтониан $F_t(x)$ и «измерим его величину».
Затем минимизируем результат измерения по всем таким потокам.
Остаётся понять, что значит «измерить его величину».
Напомним, что при любом $t$ функция $F_t$ является элементом алгебры Ли $\A$.
Возьмём любую безкоординатную норму $\|\ \|$ на $\A$,
т. е. потребуем, чтобы 
\begin{equation}
 \|H \circ \psi^{-1}\|
= \| H \|
\quad\text{при всех}\quad
H \in \A,\  \psi \in \Ham (M, \Omega).
\label{2.1.A}
\end{equation}
Теперь определим величину как  $\int_0^1\| F_t \|\, dt.$
Собрав все части этой процедуры, получаем следующую вариационную задачу 
\begin{equation}
\inf\int_0^1 \| F_t \|\,dt, 
\label{2.1.B}
\end{equation}
где $\phi$ фиксировано, а точная нижняя грань берётся по всем потокам $\{f_t\}$, как сказано выше.

\section[\texorpdfstring{Биинвариантные геометрии на $\Ham(M, \Omega)$}{Биинвариантные геометрии на Ham(M,Ω)}]{Биинвариантные геометрии\\ на $\bm{\Ham(M, \Omega)}$}\label{2.2}

Приведённая вариационная задача может быть переформулирована в чисто геометрических терминах.
Для этого надо вспомнить понятие \rindex{финслерва структура}\emph{финслервой структуры} на многообразии.
Мы говорим, что многообразие $Z$ наделено финслерной структурой, если его касательные пространства $\T_z Z$ оснащены нормой, которая гладко зависит от точек $z \in Z$.
Конечно же, римановы структуры являют частный случай этого понятия.
Однако в общем случае, нормы не обязаны задаваться скалярными произведениями.
Финслерву структуру можно использовать при определения длины кривой
точно так же, как риманову структуру 
\[\length \{z(t)\}_{t\in [a; b]} =\int_a^b \norm(\dot z (t))\,dt.\]
Кроме того, можно ввести {}\emph{расстояние} между двумя точками $z$ и $z'$ в $Z$ как инфимум длин всех кривых, соединяющих $z$ с $z'$.

Вернёмся к ситуации, описанной в предыдущем разделе.
Поскольку все касательные пространства группы $\Ham(M, \Omega)$ можно
отождествить с $\A$ (см. раздел \ref{1.4} выше), каждый выбор нормы
$\|\ \|$ на $\A$ определяет финслерову структуру на группе.
Таким образом, можно определить длину гамильтонова пути и расстояние между двумя гамильтоновыми диффеоморфизмами.
В частности, длина гамильтонова пути $\{f_t\}$, $t \in [a; b]$ с нормализованным гамильтонианом $F$ определяется следующим образом \index[symb]{$\length\{f_t\}$}
\[\length\{f_t\}=\int_a^b \| F_t \|\,dt.\]
А расстояние между двумя гамильтоновыми диффеоморфизмами $\phi$ и $\psi$ определяется как \index[symb]{$\rho$}
\[\rho (\phi, \psi) = \inf \length \{f_t\},\] 
где инфимум берётся по всем гамильтоновым путям $\{f_t\}$, $t \in [a; b]$ с $f_a = \phi$ и $f_b = \psi$.
Конечно, длина пути не зависит от параметризации, таким образом, в приведённом определении расстояния можно считать, что $a = 0$ и $b = 1$.
На этом языке, решение вариационной задачи
\ref{2.1.B} есть ничто иное, как расстояние $\rho (\1, \phi)$!

Следующие свойства $\rho$ легко проверить и даются в качестве упражнения:
\begin{itemize}
\item $\rho (\phi, \psi) = \rho (\psi, \phi)$;
\item неравенство треугольника: $\rho (\phi, \psi) + \rho (\psi, \theta) \ge \rho (\phi, \theta)$;
\item $\rho (\phi, \psi) \ge 0$.
\end{itemize}

Напомним теперь об условии \ref{2.1.A}, которое было накложено на норму $\|\ \|$ в разделе \ref{2.1}.
На геометрическом языке это означает, что норма инвариантна относительно присоединённого действия группы на её алгебре Ли (см. \ref{1.4}).
В дальнейшем мы будем иметь дело только с такими нормами.

\begin{ex*}{Упражнение}
Покажите что из \ref{2.1.A} следует, что функция $\rho$ --- \rindex{биинвариантная (псевдо)метрика}\emph{биинвариантна},%
\footnote{без \ref{2.1.A} мы получаем только правoинвариантность $\rho$, то есть $\rho (\phi, \psi) \z= \rho (\phi\theta, \psi\theta)$.
Такие метрики играют важную роль в гидродинамике, см. \cite{AK}.}
то есть
\[\rho (\phi, \psi) = \rho (\phi \theta, \psi \theta) = \rho (\theta\phi, \theta\psi)\]
при всех $\phi, \psi, \theta \in \Ham (M, \Omega)$.
\end{ex*}

Было бы честней назвать функцию $\rho$ \rindex{псевдометрика}\emph{псевдометрикой}.
Действительно, как было видно выше, она удовлетворяет всем аксиомам метрики, за исключением, возможно, {}\emph{невырожденности}, то есть 
\begin{equation}
\rho (\phi, \psi)> 0
\quad\text{при}\quad
\phi \ne \psi.
\label{eq:2.2.A}
\end{equation}

Даже в конечномерном случае, невырожденность проверить непросто.
В этом случае, доказательство использует локальнокомпактность многообразия.
В нашей ситуации группа $\Ham (M, \Omega)$ бесконечномерна и не имеет никаких свойств компактности.
Таким образом, априори у \ref{eq:2.2.A} нет причин быть верным.
Как мы скоро увидим, свойство невырожденности $\rho$ очень чувствительно к выбору нормы~$\|\ \|$.

\section[\texorpdfstring{Выбор нормы: $L_p$ или $L_\infty$}{Выбор нормы: Lₚ или L∞}]{Выбор нормы: \bm{$L_p$} или \bm{$L_\infty$}}

Среди норм на $\A$, удовлетворяющих предположению инвариантности
\ref{2.1.A} существует очень естественный класс, который включает
нормы \?{$L_p$, $p = 1, 2, 3,\dots$}{Почему только целые $p$. Не лучше
было бы написать $p\in[1;\infty)$?. То же и в теореме.}
\[\|H\|_p=\left(\int_M|H|^p\Vol\right)^{\frac1p},\]
и $L_\infty$-норму 
\[\|H\|_\infty = \max H - \min H.\]
Обозначим через $\rho_p$ и $\rho_\infty$ соответствующие псевдометрики.

\begin{thm}{Теорема}\label{2.3.A}
Псевдометрика $\rho_p$ вырождена при всех конечных $p = 1, 2,\dots$
Более того, если многообразие замкнуто, то все такие $\rho_p$ тождественно обращаются в нуль.
\end{thm}

Этот результат получен в \cite{EP}.
Доказательство представлено ниже в этой главе (см. также книги \cite{HZ}, \cite{MS}, \cite{AK}).
Следующая теорема показывает разительный контраст между $L_p$ и $L_\infty$.

\begin{thm}{Теорема}\label{2.3.B}
Псевдометрика $\rho_\infty$ невырождена.
\end{thm}

Эта теорема%
\footnote{Историческое отступление, приведённое ниже, отражает моё личное мнение.
Допускаю, что другие участники этих событий видят дело иначе.}
была сформулирована и доказана Хофером в \cite{H1} в случае $M = \RR^{2n}$ с использованием бесконечномерных вариационных методов.
В \cite{V1} Витербо вывел его в случае $M = \RR^{2n}$, используя свою теории производящих функций.
Для обоих, Хофера и Витербо, толчком послужил вопрос, заданный \rindex{Элиашберг}Элиашбергом в частной беседе.
В \cite{P1} это утверждение было распространено на широкий класс симплектических многообразий с «хорошим» поведением на бесконечности и, в частности, на все замкнутые симплектические многообразия, у которых класс когомологий симплектической формы является рациональным.
Подход \cite{P1} основан на теории псевдоголоморфных кривых \rindex{Громов}Громова.
Наконец \cite{LM1} Лалонде и Макдафф доказали \ref{2.3.B} в полной общности, используя теорию Громова.
К настоящему времени найдены другие доказательства различных частных случаев этой теоремы, см., например, \rindex{Чеканов}\rindex{Шварц}\cite{Ch,O3,Sch3}.
Первоначальное доказательство Хофера подробно представлена в книге
\cite{HZ}.
Доказательство \rindex{Лалонд}Лалонда и Макдафф изложены в книге \cite{MS} и в обзоре \cite{L}.
Ниже приводится другое доказательство в случае $M = \RR^{2n}$, которое следует из \cite{P1}.
Все известные доказательства основаны на «жёстких» методах.%
\footnote{Более того, на мой вкус, все доказательства далеко не прозрачны.
Аргумент, представленный в главе 3 ниже, не является исключением.
Я твердо верю, что в будущем будет найдено {}\emph{правильное объяснение} этому фундаментальному результату.}

\section{Понятие энергии смещения}\label{sec:2.4}

Какие инвариантные нормы $\|\ \|$ на $\A$ (то есть, удовлетворяющие \ref{2.1.A}) приводят к невырожденным метрикам $\rho$?
Ниже описана очень полезная переформулировка этого вопроса, которая в конечном счёте позволит доказать теорему \ref{2.3.A}.
Она основана на красивом понятии энергии смещения --- прекрасной идее, введённой \rindex{Хофер}Хофером \cite{H1}.
Пусть $\rho$ --- биинвариантное псевдометрика на $\Ham (M, \Omega)$, и пусть \?{$A$}{$A$ похоже на $\A$} --- ограниченное подмножество $M$.

\begin{ex*}{Определение}
\rindex{энергия смещения}\emph{Энергия смещения} $A$ определяется как \index[symb]{$\e(A)$}
\[\e(A) = \inf \set{\rho (\1, f)}{f \in \Ham (M, \Omega), f (A) \cap A = \emptyset}.\]
\end{ex*}

Множество таких $f$ может быть пустым.
Напомним, что нижняя грань пустого множества равна $+\infty$.
Если $\e (A) \ne 0$, то мы говорим, что $A$ имеет положительную энергию смещения.

Отметим пару очевидных, но важных свойств $\e(A)$.
Прежде всего, $\e$ является монотонной функцией подмножеств: если $A \subset B$, то $\e(A) \le \e(B)$.
Во-вторых, $\e$ --- инвариантна, то есть, $\e (A) = \e (f (A))$ для любого гамильтонова диффеоморфизма $f$ на $M$.
Оставим доказательства читателю.

\begin{ex*}{Пример}
Рассмотрим $(\RR^2, \omega)$ и возьмём открытый квадрат $A$, рёбра которого имеют длину $u$ и параллельны осям координат.
Оценим энергию смещения $A$ относительно расстояния $\rho_\infty$.
Рассмотрим гамильтониан $H (p, q) = up$.
Соответствующая гамильтонова система имеет вид 
\[
\begin{cases}
\dot q &= u
\\
\dot p &= 0
\end{cases}
\]
Следовательно, за единичное время, $(p, q)$ переходит в $(p, q + u)$.
Обратите внимание, что движение квадрата происходит в прямоугольнике $K = \Closure (A \cup h (A))$.
Рассмотрим \?{\rindex{срезка}\emph{срезку}}{cut-off} $F$ гамильтониана $H$ вне малой окрестности $K$.%
\footnote{Пусть $Y$ --- замкнутое подмножество многообразия $Z$, и пусть $H$ --- гладкая функция, определённая в окрестности $V$ многообразия $Y$.
Под срезкой $F$ функции $H$ вне малой окрестности $Y$ понимается следующее.
Выберем окрестность $W\supset Y$, замыкание которой содержится в $V$.
Возьмём гладкую функцию $a\colon Z \to [0; 1]$, которая равна $1$ на $W$ и обращается в нуль вне $V$.
Определим $F$ как $aH$ на $V$ и продолжим её нулём вне $V$.}
Обратите внимание, что $F$ --- нормализованный гамильтониан (в отличие от $H$).
Поскольку $F = H$ на $K$, гамильтонов поток $f$, порождённый $F$, по-прежнему смещает квадрат $A$.
Срезку всегда можно выполнить так, что $L_\infty$-норма $F$ произвольно близка к перепаду $H$ на $K$.
Перепад определяется как 
\[\max_K H - \min_K H = u^2 - 0 = u^2.\]
Таким образом, получаем, что 
\[\e (A) \le u^2 = \Area (A).\]
\end{ex*}

Обратите внимание, что квадрат симплектоморфен диску той же площади в $\RR^2$ (это неверно в более высоких размерностях!).
Таким образом, мы доказали, что $\e (B^2 (r)) \le \pi r^2$.
Глубокий результат \rindex{Хофер}Хофера \cite{H1} утверждает, что на самом деле равенство
достигается во всех размерностях, то есть, $\e (B^{2n} (r)) = \pi r^2$.
Обобщение на произвольные симплектические многообразия можно найти в \rindex{Лалонд}\cite{LM1}.
Нижняя оценка на $\e(B^{2n} (r))$ будет дана в следующей главе.

В общем случае, если энергия смещения всех непустых открытых подмножеств относительно некоторой биинвариантной псевдометрики $\rho$ положительна, то $\rho$ невырождена.
И в самом деле, любой $f \in \Ham (M, \Omega)$ такой, что $f \ne \1$,
должен сместить некоторый маленький шарик $A \subset M$.
Таким образом, получаем, что $\rho (\1, f) \ge \e (A)> 0$.
На самом деле верно и обратное.

\begin{thm}[(\cite{EP})]{Теорема}\label{2.4.A}
Если $\rho$ невырождено, то $\e (A)> 0$ для любого непустого открытого подмножества $A$.
\end{thm}

В доказательстве нам потребуется следующая лемма.

\begin{thm}{Лемма}\label{2.4.B}
Пусть $A \subset M$ --- непустое открытое подмножество.
Тогда $\e (A) \ge \tfrac14 \rho (\1, [\phi, \psi])$ при любых $\phi, \psi \in \Ham (M, \Omega)$ таких, что $\supp (\phi) \subset A$ и $\supp (\psi) \subset A$.
\end{thm}

Здесь $[\phi, \psi]$ обозначает коммутатор $\psi^{-1} \phi^{-1} \psi\phi$.
Теорема сразу следует из леммы ввиду предложения \ref{1.5.B} предыдущей главы.

\parit{Доказательство \ref{2.4.A}.} 
Согласно \ref{1.5.B} существуют $\phi$, $\psi$ с носителем в $A$ такие, что $[\phi, \psi] \ne \1$.
Поскольку $\rho$ невырождено, отсюда следует, что $\e (A) \ge \tfrac14 \rho (\1, [\phi, \psi])> 0$.
\qeds

\parit{Доказательство \ref{2.4.B}.}%
\footnote{Лёня, может сменить доказательство на следующее?

\parit{Доказательство \ref{2.4.B}.}
Для $x$ в группе $\Gamma$ с биинвариантной метрикой $\rho$ обозначим
временно $\|x\|\z\df\rho(\1,x)$.
Тогда
\[
\|xz\|-\|y\|
\le
\|xyz\|
\le
\|xz\|+\|y\|
\]
при любых $x,y,z\in \Gamma$.
Пусть $\phi,\psi,h\in \Gamma$ такие, что $[\phi,\psi^{h}]=\1$, тогда
\[
0=\big\|[\phi,\psi^{h}]\big\|
\ge
\big\|[\phi,\psi]\big\| - 4\cdot\|h\|
\]
потому что $h$ встречается в $[\phi,\psi^{h}]$ четыре раза.

В условиях леммы носители $\phi$ и $\psi^{h}$ не пересекаются,
так как $h$ смещает множество $A$ содержащее носители как $\phi$, так и
$\psi$.
Поэтому $[\phi,\psi^{h}]=\1$ и неравенство выше применимо.
\qeds
}
Предположим, что существует $h \in \Ham (M, \Omega)$ такой, что $h (A) \cap A = \emptyset$ (если такого $h$ нету, то дело сделано --- в этом случае $\e (A) = + \infty$).
Положим $\theta = \phi h^{-1} \phi^{-1} h \z= [h, \phi^{-1}]$.
Если $x \in A$, то $h (x) \notin A$.
Поскольку $\phi = \1$ вне $A$, получаем $\phi^{-1} h (x) = h (x)$.
Итак, мы видим, что $h^{-1} \phi^{-1} h (x) = x$ и, следовательно, $\theta|_A = \phi|_A$.
Далее, $\supp (\psi) \subset A$ и, следовательно, $\phi^{-1} \psi\phi = \theta^{-1} \psi\theta$, откуда следует, что $[\phi, \psi] = [\theta, \psi]$.
Отметим, что 
\begin{align*}
\rho (\1, [\theta, \psi]) &= \rho (\1, \psi^{-1} \theta^{-1} \psi\theta) =
\\
&=\rho (\theta^{-1}, \psi^{-1} \theta^{-1} \psi) \le
\\
&\le \rho (\1, \theta^{-1}) + \rho (\1, \psi^{-1} \theta^{-1} \psi) =
\\
&= 2\rho (\1, \theta).
\end{align*}
Здесь мы воспользовались биинвариантностью $\rho$ и неравенством треугольника.
Аналогично 
\[\rho (\1, \theta) = \rho (\1, [h, \phi^{-1}]) \le 2\rho (\1, h).\]
Из двух этих неравенств, получаем 
\[\rho (\1, [\phi, \psi]) = \rho (\1, [\theta, \psi]) \le 2\rho (\1, \theta) \le 4\rho (\1, h).\]
Поскольку это верно при всех $h \in \Ham (M, \Omega)$ с $h (A) \cap A =\emptyset$, то взяв нижнюю грань, получаем $4\e (A) \ge \rho (\1, [\phi, \psi])$.
\qeds


Напомним, что теорема \ref{2.3.A} утверждает, что $L_p$-норма задаёт вырожденную псевдометрику при $p <\infty$;
более того, для замкнутых многообразий она тождественна нулю.
Давайте докажем это утверждение и за одно увидим, почему рассуждение не проходит в $L_\infty$-случае.

\parit{Доказательство \ref{2.3.A}.}
Покажем, что энергия смещения маленького шарика обнуляется.
Тогда вырождение $\rho_p$ следует из \ref{2.4.A}.
Пусть $U$ --- открытое подмножество в $M$, наделённое каноническими координатами $(x, y)$.
В этих координатах симплектическая форма $\Omega$ равна $\sum dx_i\wedge dy_i$.
Не умоляя общности можно предположить, что $U$ содержит шар $\sum(x^2_j + y_j^2) <10$.
Пусть $A \subset U$ --- шар с тем же центром радиуса $0{,}1$.
Рассмотрим (частично определённый) поток $h_t$, $t \in [0; 1]$ на $U$, который представляет собой простой сдвиг на $t$ по координате $y_1$.
Такой сдвиг порождается (ненормализованым!) гамильтонианом $H (x, y) = x_1$ на $U$.
Ясно, что $h_1 (A) \cap A = \emptyset$.
Пусть $S_t$ это сфера $h_t (\partial A)$.
Рассмотрим новый (зависящий от времени) нормализованный гамильтониан
$G_t = F_t + c_t$, где $F_t$ срезка $H$ вне небольшой окрестности $S_t$, а $c_t$ является (зависящей от времени) постоянной.
Конечно же, $c_t = 0$, если многообразие $M$ открыто, и $c_t = -\Vol(M)^{-1}\int_M F_t \Vol$, если $M$ замкнуто.
Поскольку при любом $t$ функция $G_t$ совпадает с $H$ вблизи $S_t$ с точностью до аддитивной константы, заключаем, что $\sgrad G_t = \sgrad H$ вблизи $S_t$.
Следовательно, поток $\{g_t\}$ гамильтониана $G$ удовлетворяет условию $g_t (\partial A) = h_t (\partial A)$ и, значит, $g_1 (\partial A) \cap \partial A = \emptyset$.
Но отсюда, очевидно, следует, что $g_1 (A) \cap A = \emptyset$.
Заметим теперь, что с помощью отсечения вне очень малых окрестностей $S_t$ можно добиться того, чтобы $L_p$-норма каждой функции $G_t$ была произвольно мала (в отличие от $L_\infty$-нормы!).
Следовательно, $L_p$-энергия смещения $A$ обращается в нуль.
Это завершает доказательство вырождения $\rho_p$.

Обратимся теперь ко второму утверждению теоремы, где мы предполагаем, что многообразие $M$ замкнуто.
Положим
\[G = \set{g \in \Ham (M, \Omega)}{\rho (\1, g) = 0}.\]
Выберем $f, g \in G$.
Конечно же $g^{-1} \in G$.
Далее из неравенства треугольника следует, что 
\[\rho (\1, f g) = \rho (f^{-1}, g) \le \rho (\1, f) + \rho (\1, g) = 0,\]
так что $G$ является подгруппой $\Ham (M, \Omega)$.
Поскольку $\rho$ биинвариантна, мы знаем, что если $f \in G$ и $h \in \Ham (M, \Omega)$, то $hf h^{-1} \in G$ и, значит, $G$ --- нормальная подгруппа.
По теореме Баньяги \ref{1.5.A}, группа $\Ham (M, \Omega)$ проста.
Следовательно, либо $G = {\1}$, либо $G = \Ham (M, \Omega)$.
Мы уже доказали, что $\rho_p$ вырождено, и значит $G \ne {\1}$.
Таким образом, $G$ совпадает со всей группой $\Ham (M, \Omega)$.
И значит $\rho_p$ тождественно обращается в нуль.
\qeds

\begin{ex*}{Упражнение}
Докажите, что энергия смещения $S^{2n - 2} \subset \RR^{2n-1} \z\subset \RR^{2n}$ относительно $\rho_\infty$ равна нулю.
С другой стороны, как будет видно в \ref{2.4.B} следующей главы,
существуют подмногообразия половинной размерности в $\RR^{2n}$,
которые имеют положительную энергию смещения (сравни с \ref{1.1.C} выше).
\end{ex*}

\begin{ex*}{Открытая задача}
Какие инвариантные нормы на $A$ порождают невырожденные функции расстояния $\rho$?
Верно ли, что такие нормы всегда ограничены снизу $\const\|\ \|_\infty$?
Сложность здесь в том, что пока нет классификации $\Ham (M, \Omega)$-инвариантных норм.
Возможный подход состоит в исследовании срезок.
Если срезка способна произвольно уменьшить норму, то приведённое выше рассуждение влечёт, что $\rho$ вырождено.
\end{ex*}

\begin{ex*}[\cite{EP}]{Открытая задача} 
Вполне естественно рассматривать отдельно положительную и отрицательную части метрики~$\rho_\infty$.
Более явно, положим
\begin{align*}
\rho_+ (\1, f)
&= \inf\int_0^1 \max F_t\,dt
\intertext{и}
\rho_- (\1, f) 
&= \inf \int_0^1-\min F_t\,dt.
\end{align*}
Тогда очевидно, что
\[\rho (\1, f) \ge \rho_+ (\1, f) + \rho_- (\1, f).\]
Однако во всех известных мне примерах выполняется равенство!
Было бы интересно доказать общий случай или найти контрпример.
Заметим, что из \cite{V1} следует, что на $\Ham (\RR^{2n})$ сумма $\rho_+ + \rho_-$  определяет биинвариантную метрику.
Насколько мне известно, для общих симплектических многообразий никаких аналогов этого утверждения не доказано.
\end{ex*}

\begin{ex*}{Соглашение}
В дальнейшем если не сказано противное, то мы используем обозначение \index[symb]{$\lVert\ \rVert$}\index[symb]{$\|\ \|$}$\|\ \|$ для $L_\infty$-нормы на $\A(M)$.
Через $\rho$ обозначим метрику $\rho_\infty$ и называем её \rindex{хоферовская метрика}\emph{хоферовской метрикой}.
Величину $\rho (\1, f)$ называем \rindex{хоферовская норма}\emph{хоферовской нормой} $f$.
Через $\length \{f_t\}$ обозначим длину гамильтонова пути $\{f_t\}$ относительно $L_\infty$-нормы (см. \ref{2.2} выше).
\end{ex*}
